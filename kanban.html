<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <script>
    if (!sessionStorage.getItem('sin_authenticated')) {
      window.location.href = 'login.html';
    }
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Gest√£o de Interven√ß√µes - Kanban">
  <meta name="author" content="Target Teal">

  <title>Gest√£o de Interven√ß√µes | Kanban</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="css/tokens.css">
  <link rel="stylesheet" href="css/report.css">
  <link rel="stylesheet" href="css/kanban.css">

  <!-- Favicon (teal circle) -->
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' fill='%237ab5bc'/></svg>">
</head>

<body>
  <!-- Mobile Menu Button -->
  <button id="mobile-toggle" class="mobile-menu-trigger" aria-label="Abrir menu">
    <span class="hamburger-icon"></span>
  </button>

  <!-- Overlay for Mobile Drawer -->
  <div id="sidebar-overlay" class="sidebar-overlay"></div>

  <div class="sin-shell">
    <!-- Sidebar Navigation -->
    <aside class="sin-sidebar">
      <header class="sidebar-header">
        <h1 class="sidebar-logo">üìä Frontline Sodexo</h1>
        <p class="sidebar-subtitle">Relat√≥rio Q1 2026</p>
      </header>

      <nav class="sidebar-nav">
        <div class="nav-back-link">
            <a href="index.html" class="nav-link">
                <span class="nav-icon">‚¨ÖÔ∏è</span>
                <span class="nav-title">Voltar ao Relat√≥rio</span>
            </a>
        </div>
        <div class="nav-divider"></div>
        <span class="nav-section-title">Gest√£o de Interven√ß√µes</span>
        <ul id="kanban-nav-list" class="nav-list">
           <li class="nav-item">
            <a href="#" class="nav-link active">
              <span class="nav-number">üìã</span>
              <span class="nav-title">Kanban Board</span>
            </a>
          </li>
        </ul>
      </nav>

      <footer class="sidebar-footer">
        <button id="sidebar-toggle" class="sidebar-toggle" title="Recolher Menu">
          <span class="toggle-arrow">‚óÄ</span>
          <span class="toggle-text">Colapsar</span>
        </button>
      </footer>
    </aside>

    <!-- Main Content -->
    <main class="sin-main kanban-main">
      <header class="kanban-header">
          <h1>Gest√£o de Interven√ß√µes</h1>
          <div class="kanban-controls">
              <!-- Controls will go here later -->
          </div>
      </header>

      <div class="kanban-board-container">
        <div id="kanban-board" class="kanban-board">
            <!-- Columns will be injected by JS -->
            <div class="loading">Carregando quadro...</div>
        </div>
      </div>

      <!-- Card Details Side Panel -->
      <div id="card-editor-overlay" class="editor-overlay"></div>
      <aside id="card-editor" class="card-editor-panel">
        <header class="editor-header">
            <div class="editor-title-group">
                <span id="editor-card-id" class="editor-id">I-00</span>
                <h2 id="editor-card-title">T√≠tulo da Interven√ß√£o</h2>
            </div>
            <button id="close-editor" class="close-editor-btn" aria-label="Fechar">√ó</button>
        </header>

        <div class="editor-content">
            <!-- Read-only details from Markdown -->
            <div class="editor-section read-only-section">
                <div class="editor-field">
                    <label>Origem</label>
                    <div id="editor-article-source" class="readonly-value">Artigo 01</div>
                </div>
                <div class="editor-field">
                    <label>Descri√ß√£o Original</label>
                    <div id="editor-description" class="readonly-value description-text"></div>
                </div>
                <div class="editor-actions">
                    <a id="editor-view-source" href="#" class="btn-secondary btn-sm" target="_blank">üìÑ Ver Contexto Original</a>
                </div>
            </div>

            <hr class="editor-divider">

            <!-- Editable Management Fields -->
            <form id="card-edit-form" class="editor-section editable-section">
                <div class="form-group">
                    <label for="edit-responsible">Respons√°vel</label>
                    <input type="text" id="edit-responsible" class="form-input" placeholder="Quem est√° liderando?">
                </div>

                <div class="form-group">
                    <label for="edit-duedate">Data Limite</label>
                    <input type="date" id="edit-duedate" class="form-input">
                </div>

                <div class="form-group">
                    <label for="edit-tags">Tags</label>
                    <div id="tags-container" class="tags-container">
                        <!-- Tag chips will be rendered here -->
                    </div>
                    <input type="text" id="edit-tags" class="form-input" placeholder="Digite e pressione Enter ou v√≠rgula">
                </div>

                <div class="form-group">
                    <label>Envolver</label>
                    <div id="stakeholders-list" class="stakeholders-list">
                        <!-- Stakeholder items will be rendered here -->
                    </div>
                    <div id="stakeholder-form" class="stakeholder-form" style="display: none;">
                        <input type="text" id="stakeholder-name" class="form-input" placeholder="Nome *" required>
                        <input type="text" id="stakeholder-area" class="form-input" placeholder="√Årea (opcional)">
                        <input type="text" id="stakeholder-contact" class="form-input" placeholder="Contato (opcional)">
                        <div class="stakeholder-form-actions">
                            <button type="button" id="stakeholder-save" class="btn-sm btn-primary">Adicionar</button>
                            <button type="button" id="stakeholder-cancel" class="btn-sm btn-secondary">Cancelar</button>
                        </div>
                    </div>
                    <button type="button" id="add-stakeholder-btn" class="btn-add-stakeholder">+ Adicionar pessoa</button>
                </div>

                <div class="form-group">
                    <label for="edit-updates">√öltimas Atualiza√ß√µes / Log</label>
                    <textarea id="edit-updates" class="form-input form-textarea" rows="6" placeholder="Registre o progresso, bloqueios ou decis√µes..."></textarea>
                </div>

                <div class="form-footer">
                    <button type="submit" class="btn-primary">üíæ Salvar Altera√ß√µes</button>
                    <span id="editor-save-status" class="save-status"></span>
                </div>
            </form>
        </div>
      </aside>

      <footer class="report-footer">
          Relat√≥rio Sodexo Frontline | Target Teal | 2026
      </footer>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

  <!-- Application -->
  <script type="module" src="js/kanban.js"></script>
</body>

</html>
